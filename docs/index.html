<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.16.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Solari Cifra 5 Firmware: STM32G0 Firmware for Solari Cifra5 Clock</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Solari Cifra 5 Firmware<span id="projectnumber">&#160;2.0</span>
   </div>
   <div id="projectbrief">STM32G031K8 FreeRTOS firmware for Solari Cifra 5 mechanical flip clock</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.16.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('index.html','',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">STM32G0 Firmware for Solari Cifra5 Clock </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md__r_e_a_d_m_e"></a></p>
<p><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://img.shields.io/badge/License-CC_BY--NC--SA_4.0-lightgrey.svg" alt="License: CC BY-NC-SA 4.0" style="pointer-events: none;" class="inline"/></a></p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md1"></a>
Follow the project on <a href="https://hackaday.io/project/183679-solari-cifra-5-hack">Hackaday</a></h1>
<p>FreeRTOS firmware for the STM32G031K8 that drives a Solari Cifra 5 mechanical flip clock. Controls hour flaps via servo, minute flaps via electromagnetic coil, and provides a full UI on an SSD1306 OLED display with 3 tactile buttons.</p>
<h2 class="doxsection"><a class="anchor" id="autotoc_md2"></a>
Features</h2>
<ul>
<li><b>3 FreeRTOS tasks</b> — display (UI state machine), button (scan + debounce + long press), clock (sync + tick)</li>
<li><b>Mechanical synchronization</b> — sensor-based zero search and fast re-sync from backup registers</li>
<li><b>Silent period</b> — configurable hours when the mechanism stays quiet (e.g. 22:00-09:00)</li>
<li><b>RTC smooth calibration</b> — adjustable crystal compensation (0-511 pulses per 32s window)</li>
<li><b>Settings persistence</b> — silent hours and calibration stored in Flash, restored on battery loss</li>
<li><b>First-boot setup wizard</b> — guides through silent hours, calibration, and time setting</li>
</ul>
<h2 class="doxsection"><a class="anchor" id="autotoc_md3"></a>
Notes</h2>
<p>This implementation doesn't use the CMSIS FreeRTOS provided by the STM32Cube IDE; I studied all the functions from the FreeRTOS manual, so I found the CMSIS wrapper confusing.</p>
<p>The display driver is an evolution of the one developed by Stefan Wagner, subsequently improved, and ported to STM32 by me. The main characteristic of this driver is that it doesn't require a display memory map inside the MCU, so in a tight memory configuration like this one, it can be handy. If you are interested in its functionality, I suggest reading the full article published <a href="https://hackaday.io/project/181543-no-buffer-ssd1306-display-driver-for-stm32">here</a> on Hackaday.</p>
<h1 class="doxsection"><a class="anchor" id="autotoc_md4"></a>
License</h1>
<p>Licensed under <b>Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International</b> (CC BY-NC-SA 4.0). See <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">LICENSE</a> for full license text. </p>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"></a>
</div><!-- contents -->
</div><!-- doc-content -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.16.1 </li>
  </ul>
</div>
</body>
</html>
